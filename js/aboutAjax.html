<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>欢迎来到ALin的个人博客 | ALin的个人博客</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="ALin的个人博客" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1></h1></div><hr><div id="post-content"><h2 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h2><p>就是异步的js和XML<br>通过ajax可以在浏览器中向服务器发送异步请求，最大的优势：无刷新获取数据<br>ajax不是新的编程语言，而是一种将现有标准组合在一起使用的新方式</p>
<h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><p>可扩展标记语言<br>XML被设计用来传输和存储数据<br>XML与HTML类似，不同的是HTML中都是预定义标签，而XML中没有预定义标签，全都是自定义标签，用来表示一些数据<br>比如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">student</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>孙悟空<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>18<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">gender</span>&gt;</span>男<span class="hljs-tag">&lt;/<span class="hljs-name">gender</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">student</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="ajax优点"><a href="#ajax优点" class="headerlink" title="ajax优点"></a>ajax优点</h3><ol>
<li>可以无需刷新页面而与服务端进行通信</li>
<li>允许你根据用户事件来更新部分页面内容<h3 id="ajax缺点"><a href="#ajax缺点" class="headerlink" title="ajax缺点"></a>ajax缺点</h3></li>
<li>没有浏览历史，不能回退</li>
<li>存在跨域问题(同源)</li>
<li>SEO不友好（SEO搜索引擎优化）</li>
</ol>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>超文本传输协议 ，详细规定了浏览器和万维网服务器之间的通信规则</p>
<h3 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h3><p>重点是格式与参与</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">行 <span class="hljs-variable constant_">GET</span> / s?ie=utf-<span class="hljs-number">8</span> <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br>头 <span class="hljs-attr">HOST</span>:hhhh.<span class="hljs-property">com</span><br>   <span class="hljs-title class_">Cookie</span>:name=haha<br>   <span class="hljs-title class_">Content</span>-<span class="hljs-attr">type</span>:application/x-www-form-urlencoded<br>   <span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>:chrome <span class="hljs-number">83</span><br>空行<br>体 get请求，请求体可以为空，但post不可以 username=admin&amp;password=<span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure>

<h3 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">行 HTTP/1.1  200 OK<br>头 HOST:hhhh.com<br>   Cookie:name=haha<br>   Content-type:text/html;charset=utf-8<br>   Content-length:2048<br>   Content-encoding:gzip<br>空行<br>体 &lt;html&gt;<br>        &lt;head&gt;&lt;/head&gt;<br>        &lt;body&gt;<br>            &lt;h1&gt;哈哈哈&lt;/h1&gt;<br>        &lt;/body&gt;<br>    &lt;/html&gt;<br></code></pre></td></tr></table></figure>

<h2 id="express基本使用"><a href="#express基本使用" class="headerlink" title="express基本使用"></a>express基本使用</h2><p>基于nodejs平台</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 引入express框架</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 2. 创建应用对象</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-comment">// 3. 创建路由规则</span><br>    <span class="hljs-comment">// request是对请求报文的封装</span><br>    <span class="hljs-comment">// response是对响应报文的封装</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO EXPRESS&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 4. 监听端口启动服务</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;服务器已经启动,8000端口监听中&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><ul>
<li>server.js</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 引入express框架</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 2. 创建应用对象</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-comment">// 3. 创建路由规则</span><br>    <span class="hljs-comment">// request是对请求报文的封装</span><br>    <span class="hljs-comment">// response是对响应报文的封装</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX GET&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 4. 监听端口启动服务</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;服务器已经启动,8000端口监听中&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="ajax请求的基本操作"><a href="#ajax请求的基本操作" class="headerlink" title="ajax请求的基本操作"></a>ajax请求的基本操作</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;result&quot;</span>)<br><span class="hljs-comment">// 1.创建对象</span><br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br><span class="hljs-comment">// 2. 初始化 设置请求方法和url</span><br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/server&#x27;</span>);<br><span class="hljs-comment">// 3. 发送</span><br>xhr.<span class="hljs-title function_">send</span>()<br><span class="hljs-comment">// 4. 事件绑定  处理服务端返回的结果</span><br><span class="hljs-comment">// readystate 是 xhr对象中的属性,表示状态0,1,2,3,4</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 判断</span><br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-comment">// 判断响应状态码 200 404 403 500</span><br>        <span class="hljs-comment">// 2xx 都是成功</span><br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            <span class="hljs-comment">// 处理结果 行 头  空行  体</span><br>            <span class="hljs-comment">// 1. 响应行</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">status</span>) <span class="hljs-comment">// 状态码</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">statusText</span>) <span class="hljs-comment">// 状态字符串</span><br>            <span class="hljs-comment">// 2. 所有响应头</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-title function_">getAllResponseHeader</span>())<br>            <span class="hljs-comment">// 3. 响应体</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>) <br>            <span class="hljs-comment">// 设置result的文本</span><br>            result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span><br>        &#125;<span class="hljs-keyword">else</span> &#123;<br><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="url要设置参数"><a href="#url要设置参数" class="headerlink" title="url要设置参数"></a>url要设置参数</h3><p>xhr.open(‘GET’,’<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/server?a=100&amp;b=200&amp;c=300&#39;">http://127.0.0.1:8000/server?a=100&amp;b=200&amp;c=300&#39;</a>);</p>
<h2 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// server.js 要在get下面继续添加一个post请求</span><br><span class="hljs-comment">// 1. 引入express框架</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 2. 创建应用对象</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-comment">// 3. 创建路由规则</span><br>    <span class="hljs-comment">// request是对请求报文的封装</span><br>    <span class="hljs-comment">// response是对响应报文的封装</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX GET&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX POST&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 4. 监听端口启动服务</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;服务器已经启动,8000端口监听中&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="post请求-url如何设置参数"><a href="#post请求-url如何设置参数" class="headerlink" title="post请求 url如何设置参数"></a>post请求 url如何设置参数</h3><p>这三种方式都可以<br>xhr.send(‘a=100&amp;b=200&amp;c=300’)<br>xhr.send(‘a:100&amp;b:200&amp;c:300’)<br>xhr.send(‘123341551’)</p>
<h3 id="post设置请求头"><a href="#post设置请求头" class="headerlink" title="post设置请求头"></a>post设置请求头</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/server&#x27;</span>);<br><span class="hljs-comment">// 设置请求头</span><br>xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>,<span class="hljs-string">&#x27;application/x-www-form-urlended&#x27;</span>)<br>xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;hahah&#x27;</span>)<br><span class="hljs-comment">// Content-Type设置请求体类型</span><br>xhr.<span class="hljs-title function_">send</span>()<br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 想发请求头需要在server中添加一句话</span><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX POST&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="服务端响应JSON数据"><a href="#服务端响应JSON数据" class="headerlink" title="服务端响应JSON数据"></a>服务端响应JSON数据</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// server.js</span><br><span class="hljs-comment">// app.all可以接收任意类型的数据</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/json-server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-comment">// 响应一个数据</span><br>    <span class="hljs-keyword">const</span> data = &#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;hahha&#x27;</span><br>    &#125;<br>    <span class="hljs-comment">// 对对象进行字符串转换</span><br>    <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)<br>    <span class="hljs-comment">// 设置响应</span><br>    response.<span class="hljs-title function_">send</span>(str) <span class="hljs-comment">// send方法只能支持字符串和buffer</span><br>&#125;)<br><br><span class="hljs-comment">// 之后服务器返回结果是&#123;&quot;name&quot;:&quot;hahha&quot;&#125;</span><br><span class="hljs-comment">// 可以这么做</span><br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&#x27;json&#x27;</span> <span class="hljs-comment">// 这个与第二个方法，自动转换，搭配使用</span><br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/json-server&#x27;</span>);<br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            <span class="hljs-comment">// 1. 手动对数据进行转换</span><br>            <span class="hljs-keyword">let</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">response</span>)<br>            <span class="hljs-comment">// console.log(xhr.response) //&#123;&quot;name&quot;:&quot;hahha&quot;&#125;</span><br>            result.<span class="hljs-property">innerHTML</span> = data.<span class="hljs-property">name</span><br>            <span class="hljs-comment">// 2. 自动转换</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>) <span class="hljs-comment">//&#123;&quot;name&quot;:&quot;hahha&quot;&#125;</span><br>            result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span>.<span class="hljs-property">name</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>buffer缓冲区，专门用于存储二进制数据，用法与数组类似</li>
</ul>
<h2 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h2><p>可以帮我们自动重新启动应用</p>
<h2 id="IE问题"><a href="#IE问题" class="headerlink" title="IE问题"></a>IE问题</h2><p>IE浏览器会对ajax请求结果做一个缓存，会导致下一次请求走的是本地缓存而不是服务器返回的最新数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/ie?t=&#x27;</span>+<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()); <span class="hljs-comment">// 加一个参数，让它每一次获取最新值</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="请求超时与网络异常"><a href="#请求超时与网络异常" class="headerlink" title="请求超时与网络异常"></a>请求超时与网络异常</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// server.js</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/delay&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">// 设置响应</span><br>        response.<span class="hljs-title function_">send</span>(str)<br>    &#125;,<span class="hljs-number">3000</span>)<br>&#125;)<br><br><br><br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>    <span class="hljs-comment">// 超时设置</span><br>    xhr.<span class="hljs-property">timeout</span> = <span class="hljs-number">2000</span> <span class="hljs-comment">// 2s内没有结果就取消</span><br>    <span class="hljs-comment">// 超时回调</span><br>    xhr.<span class="hljs-property">ontimeout</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;网络异常，稍后重试&quot;</span>)<br>    &#125;<br>    <span class="hljs-comment">// 网络异常回调</span><br>    xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;您的网络出现一些问题！&#x27;</span>)<br>    &#125;<br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>); <br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>            <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>                result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="ajax取消请求"><a href="#ajax取消请求" class="headerlink" title="ajax取消请求"></a>ajax取消请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>)<br><span class="hljs-keyword">let</span> xhr = <span class="hljs-literal">null</span><br>btn[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>); <br>    xhr.<span class="hljs-title function_">send</span>()<br>&#125;<br><span class="hljs-comment">// abort方法，属于ajax对象</span><br>btn[<span class="hljs-number">1</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    xhr.<span class="hljs-title function_">abort</span>() <span class="hljs-comment">// 这两个处在不同的函数内部，不能直接调用，所以把xhr放在外侧也就有了let xhr = null</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="ajax请求重复发送"><a href="#ajax请求重复发送" class="headerlink" title="ajax请求重复发送"></a>ajax请求重复发送</h2><p>如果用户一直点，服务器压力会很大，会接收很多相同请求 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 设置一个标识变量</span><br><span class="hljs-keyword">let</span> isSending = <span class="hljs-literal">false</span> <span class="hljs-comment">// 是否正在发送ajax请求</span><br><span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>)<br><span class="hljs-keyword">let</span> xhr = <span class="hljs-literal">null</span><br>btn[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(isSending) xhr.<span class="hljs-title function_">abort</span>() <span class="hljs-comment">// 如果正在发送则取消该请求，创建一个新请求</span><br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>); <br>    xhr.<span class="hljs-title function_">send</span>()<br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <br>        <span class="hljs-comment">// 修改标识变量 的值</span><br>        isSending = <span class="hljs-literal">false</span><br>        <span class="hljs-comment">// 这里不需要加状态码判断，因为可能是一个失败的请求</span><br>    &#125;<br>&#125;<br>&#125;<br><span class="hljs-comment">// abort方法，属于ajax对象</span><br>btn[<span class="hljs-number">1</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    xhr.<span class="hljs-title function_">abort</span>() <span class="hljs-comment">// 这两个处在不同的函数内部，不能直接调用，所以把xhr放在外侧也就有了let xhr = null</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 配置baseURL</span><br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">&#x27;http:// http://127.0.0.1:8000&#x27;</span><br><span class="hljs-comment">// GET请求</span><br>axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/ axios-server&#x27;</span>,&#123;<br>    <span class="hljs-comment">// url参数</span><br>    <span class="hljs-attr">params</span>:&#123;<br>        <span class="hljs-attr">id</span>:<span class="hljs-number">100</span>,<br>        <span class="hljs-attr">vip</span>:<span class="hljs-number">7</span><br>    &#125;,<br>    <span class="hljs-comment">// 请求头</span><br>    <span class="hljs-attr">headers</span>:&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;hahah&#x27;</span>,<br>        <span class="hljs-attr">age</span>:<span class="hljs-number">20</span><br>    &#125;<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value)<br>&#125;)<br><br><span class="hljs-comment">// post 请求</span><br>axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/ axios-server&#x27;</span>,&#123;<br>    <span class="hljs-comment">// url参数</span><br>    <span class="hljs-attr">params</span>:&#123;<br>        <span class="hljs-attr">id</span>:<span class="hljs-number">100</span>,<br>        <span class="hljs-attr">vip</span>:<span class="hljs-number">7</span><br>    &#125;,<br>    <span class="hljs-attr">headers</span>:&#123;<br>        <span class="hljs-attr">height</span>:<span class="hljs-number">180</span>;<br>        <span class="hljs-attr">weight</span>:<span class="hljs-number">120</span><br>    &#125;,<br>    <span class="hljs-comment">// 请求体</span><br>    data :&#123; <span class="hljs-comment">// 如果参数第二个是对象，直接作为请求体</span><br>        <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;hahah&#x27;</span>,<br>        <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;1234&#x27;</span><br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">// 所以</span><br>axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/axios-server&#x27;</span>,&#123; <span class="hljs-comment">// 第一个参数url，第二个参数请求体，第三个参数其他配置</span><br>    <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;hahah&#x27;</span>,<br>    <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;1234&#x27;</span><br>    &#125;,<br>    &#123;<br>        <span class="hljs-comment">// url参数</span><br>        <span class="hljs-attr">params</span>:&#123;<br>            <span class="hljs-attr">id</span>:<span class="hljs-number">100</span>,<br>            <span class="hljs-attr">vip</span>:<span class="hljs-number">7</span><br>        &#125;,<br>        <span class="hljs-attr">headers</span>:&#123;<br>            <span class="hljs-attr">height</span>:<span class="hljs-number">180</span>;<br>            <span class="hljs-attr">weight</span>:<span class="hljs-number">120</span><br>        &#125;<br>    &#125;<br>) <br></code></pre></td></tr></table></figure>

<h2 id="axios发送请求"><a href="#axios发送请求" class="headerlink" title="axios发送请求"></a>axios发送请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;POST &#x27;</span><br>    <span class="hljs-comment">// url</span><br>    <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;/axios-server&#x27;</span>,<br>    <span class="hljs-comment">// url参数</span><br>    <span class="hljs-attr">params</span>:&#123;<br>        <span class="hljs-attr">vip</span>:<span class="hljs-number">10</span>,<br>        <span class="hljs-attr">level</span>:<span class="hljs-number">9</span><br>    &#125;,<br>    <span class="hljs-comment">// 头信息</span><br>    <span class="hljs-attr">headers</span>:&#123;<br>        <span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<br>        <span class="hljs-attr">b</span>:<span class="hljs-number">200</span><br>    &#125;,<br>    <span class="hljs-comment">// 请求体</span><br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;hahah&#x27;</span>,<br>        <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;1234&#x27;</span><br>    &#125;<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// 1. 响应行</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>) <span class="hljs-comment">// 状态码</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">statusText</span>) <span class="hljs-comment">// 状态字符串</span><br>    <span class="hljs-comment">// 2. 响应头信息</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">headers</span>)<br>    <span class="hljs-comment">// 3. 响应体</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>) <br>&#125;)<br></code></pre></td></tr></table></figure>


<h2 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/fetch-server&#x27;</span>,&#123;<br>    <span class="hljs-comment">// 请求方法</span><br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-attr">header</span>:&#123; <span class="hljs-comment">// 请求头中不要有中文</span><br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;hahha&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">body</span>:<span class="hljs-string">&#x27;username=admin&amp;password=1234&#x27;</span><br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>()<br>    <span class="hljs-comment">// 如果服务端返回的是一个json，那就返回一个json方法</span><br>    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>()<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response) <span class="hljs-comment">// &#123;&quot;name&quot;:&quot;hahha&quot;&#125;</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>ajax默认遵循同源策略</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/home&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">request,response</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 设置响应头  设置允许跨域</span><br>    response.<span class="hljs-title function_">sendFile</span>(__dirname + <span class="hljs-string">&#x27;/index.html&#x27;</span>)<br>&#125;)<br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>,<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;服务器已经启动,8000端口监听中&#x27;</span>)<br>&#125;)<br><br><br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;/data&#x27;</span>); <span class="hljs-comment">// 这里因为是同源策略，所以可以简写</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<div id="paginator"></div></div><div id="post-footer"></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">John Doe</a></h1><div id="description"><p>支持大家讨论交流</p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax"><span class="toc-number">1.</span> <span class="toc-text">ajax</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XML"><span class="toc-number">2.</span> <span class="toc-text">XML</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax%E4%BC%98%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text">ajax优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax%E7%BC%BA%E7%82%B9"><span class="toc-number">2.2.</span> <span class="toc-text">ajax缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">3.</span> <span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87"><span class="toc-number">3.1.</span> <span class="toc-text">请求报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87"><span class="toc-number">3.2.</span> <span class="toc-text">响应报文</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#express%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">express基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GET"><span class="toc-number">5.</span> <span class="toc-text">GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">ajax请求的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E8%A6%81%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">6.1.</span> <span class="toc-text">url要设置参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POST%E8%AF%B7%E6%B1%82"><span class="toc-number">7.</span> <span class="toc-text">POST请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E8%AF%B7%E6%B1%82-url%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">7.1.</span> <span class="toc-text">post请求 url如何设置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E8%AE%BE%E7%BD%AE%E8%AF%B7%E6%B1%82%E5%A4%B4"><span class="toc-number">7.2.</span> <span class="toc-text">post设置请求头</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%93%8D%E5%BA%94JSON%E6%95%B0%E6%8D%AE"><span class="toc-number">8.</span> <span class="toc-text">服务端响应JSON数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nodemon"><span class="toc-number">9.</span> <span class="toc-text">nodemon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IE%E9%97%AE%E9%A2%98"><span class="toc-number">10.</span> <span class="toc-text">IE问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%B6%85%E6%97%B6%E4%B8%8E%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8"><span class="toc-number">11.</span> <span class="toc-text">请求超时与网络异常</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82"><span class="toc-number">12.</span> <span class="toc-text">ajax取消请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax%E8%AF%B7%E6%B1%82%E9%87%8D%E5%A4%8D%E5%8F%91%E9%80%81"><span class="toc-number">13.</span> <span class="toc-text">ajax请求重复发送</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axios"><span class="toc-number">14.</span> <span class="toc-text">axios</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axios%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82"><span class="toc-number">15.</span> <span class="toc-text">axios发送请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fetch"><span class="toc-number">16.</span> <span class="toc-text">fetch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F"><span class="toc-number">17.</span> <span class="toc-text">跨域</span></a></li></ol></div><section id="total"><a id="total-archives" href="/archives"><span class="total-title">文章 总数:</span><span class="total-number">5</span></a><div id="total-tags"><span class="total-title">标签:</span><span class="total-number">1</span></div><div id="total-categories"><span class="total-title">分类:</span><span class="total-number">5</span></div></section></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>