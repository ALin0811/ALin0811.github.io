<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>欢迎来到ALin的个人博客 | ALin的个人博客</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="ALin的个人博客" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1></h1></div><hr><div id="post-content"><ol>
<li>先处理数据</li>
</ol>
<ul>
<li>单个商品界面数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">UIGoods</span>(<span class="hljs-params">g</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = g<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> = <span class="hljs-number">3</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalPrice</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// 这样会造成数据冗余，因为总价是通过choose与data中的单价可以得出来的所以换成函数形式</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">UIGoods</span>(<span class="hljs-params">g</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = g<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> = <span class="hljs-number">3</span><br>&#125;<br><span class="hljs-comment">// 获取总价</span><br><span class="hljs-title class_">UIGoods</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getTotalPrice</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> <span class="hljs-comment">// 这个虽然没有数据冗余但是效率会降低，但是没有完美的代码，总要有取舍，永远不要先考虑效率问题</span><br>&#125;<br><span class="hljs-comment">// 是否选中了此件商品</span><br><span class="hljs-title class_">UIGoods</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">isChoose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> &gt; <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">var</span> uig = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UIGoods</span>(goods[<span class="hljs-number">0</span>])<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uig)<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 可以用es6的方式写上述代码</span><br><span class="hljs-comment">// 单个商品的数据</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UIGoods</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">g</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = g<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> = <span class="hljs-number">0</span><br>    &#125;<br>    <span class="hljs-comment">// 获取总价</span><br>    <span class="hljs-title function_">getTotalPrice</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">price</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> <br>    &#125;<br>    <span class="hljs-comment">// 是否选中了此件商品</span><br>    <span class="hljs-title function_">isChoose</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> &gt; <span class="hljs-number">0</span><br>    &#125;<br>    <span class="hljs-comment">// 增加选择数量 +1</span><br>    <span class="hljs-title function_">increase</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span>++<br>    &#125;<br>    <span class="hljs-comment">// 减少选择数量 -1</span><br>    <span class="hljs-title function_">decrease</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span> === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span><br>        &#125;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">choose</span>--<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> uig = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UIGoods</span>(goods[<span class="hljs-number">0</span>])<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uig)<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>整个界面的数据</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UIData</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// console.log(goods)</span><br>        <span class="hljs-keyword">var</span> uiGoods = []<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;goods.<span class="hljs-property">length</span>;i++) &#123;<br>            <span class="hljs-keyword">var</span> uig = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UIGoods</span>(goods[i])<br>            uiGoods.<span class="hljs-title function_">push</span>(uig)<br>        &#125;<br>        <span class="hljs-comment">// 保存到当前对象属性</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span> = uiGoods <br>        <span class="hljs-comment">// 起送门槛</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deliveryThreshold</span> = <span class="hljs-number">30</span><br>        <span class="hljs-comment">// 配送费</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deliveryPrice</span> = <span class="hljs-number">5</span><br>    &#125;<br>    <span class="hljs-title function_">getTotalPrice</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>.<span class="hljs-property">length</span>;i++) &#123;<br>            <span class="hljs-keyword">var</span> g = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>[i]<br>            sum += g.<span class="hljs-title function_">getTotalPrice</span>()<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum<br>    &#125;<br>    <span class="hljs-comment">// 增加某件商品选中数量</span><br>    <span class="hljs-title function_">increase</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>[index].<span class="hljs-title function_">increse</span>()<br>    &#125;<br>    <span class="hljs-comment">// 减少某件商品选中数量</span><br>    <span class="hljs-title function_">decrease</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>[index].<span class="hljs-title function_">decrese</span>()<br>    &#125;<br>    <span class="hljs-comment">// 得到总共选中的数量</span><br>    <span class="hljs-title function_">getTotalChooseNumber</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-title class_">Var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>.<span class="hljs-property">length</span>;i++) &#123;<br>            sum+=<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>[i].<span class="hljs-property">choose</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum<br>    &#125;<br>    <span class="hljs-comment">// 购物车中有没有东西</span><br>    <span class="hljs-title function_">hasGoodsInCar</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTotalChooseNumber</span>() &gt; <span class="hljs-number">0</span><br>    &#125;<br>    <span class="hljs-comment">// 是否超出配送标准</span><br>    <span class="hljs-title function_">isCrossDeliveryThreshold</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTotalPrice</span>() &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">deliveryThreshold</span> <br>    &#125;<br>    <span class="hljs-comment">// </span><br>    <span class="hljs-title function_">isChoose</span>(<span class="hljs-params">index</span>) &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>[index].<span class="hljs-title function_">isChoose</span>()<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> ui = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UIData</span>()<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>整个界面</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UI</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UIData</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span> = &#123;<br>            <span class="hljs-comment">// 商品要动态生成</span><br>            <span class="hljs-attr">goodsContainer</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.good-list&#x27;</span>);<br>            <span class="hljs-comment">// 配送费</span><br>            <span class="hljs-attr">deliverPrice</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-car-tip&#x27;</span>);<br>            <span class="hljs-comment">// 起送标准</span><br>            <span class="hljs-attr">footerPay</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-pay&#x27;</span>);<br>            <span class="hljs-attr">footerPayInnerSpan</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-pay span&#x27;</span>);<br>            <span class="hljs-attr">totalPrice</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-car-total&#x27;</span>);<br>            <span class="hljs-attr">car</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-car&#x27;</span>);<br>            <span class="hljs-attr">badge</span>:<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.footer-car-badge&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createHTML</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateFooter</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listenEvent</span>()<br>    &#125;<br><br>    <span class="hljs-comment">// 抛物线跳跃目标</span><br>    <span class="hljs-keyword">var</span> carRect = <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">car</span>.<span class="hljs-title function_">getBoundingClientRect</span>(); <span class="hljs-comment">// getBoundingClientRect()获取元素位置,这个方法没有参数 getBoundingClientRect()用于获得页面中某个元素的左,上,右和下分别相对浏览器视窗的位置</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(carRect)<br>            <span class="hljs-keyword">var</span> jumpTarget = &#123;<br>                <span class="hljs-attr">x</span>: carRect.<span class="hljs-property">left</span> + carRect.<span class="hljs-property">width</span> /<span class="hljs-number">2</span>;<br>                <span class="hljs-attr">y</span>: carRect.<span class="hljs-property">top</span> + carRect.<span class="hljs-property">height</span> /<span class="hljs-number">5</span>;<br>            &#125;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">jumpTarget</span> = jumpTarget<br><br>    <span class="hljs-comment">// 监听各种事件</span><br>    <span class="hljs-title function_">listenEvent</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">car</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;animationend&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;animate&#x27;</span>)<br>            &#125;)<br>    &#125;<br><br>    <span class="hljs-comment">// 根据商品数据创建商品列表元素</span><br>    <span class="hljs-title function_">createHTML</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">/** 两种创建方式</span><br><span class="hljs-comment">         * 生成html字符串（执行效率低，开发效率高） ，字符串需要(parse html)  选这个，不要先考虑效率</span><br><span class="hljs-comment">         * 一个一个创建元素 （执行效率高，开发效率低）</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">var</span> html = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-property">uiGoods</span>.<span class="hljs-property">length</span>;i++) &#123;<br>            <span class="hljs-keyword">var</span> g = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-property">uiGoods</span>[i]<br>            <span class="hljs-comment">// console.log(g)</span><br>            html = <span class="hljs-string">``</span> <span class="hljs-comment">// 拼接对应的div里面那一堆数据</span><br>        &#125;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">goodsContainer</span>.<span class="hljs-property">innerHTML</span> = html<br>    &#125;<br>    <span class="hljs-title function_">increase</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">increase</span>(index)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateGoodsItem</span>(index)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateFooter</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">jump</span>(index)<br>    &#125;<br>    <span class="hljs-title function_">decrease</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">decrease</span>(index)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateGoodsItem</span>(index)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateFooter</span>()<br>    &#125;<br>    <span class="hljs-comment">// 更新某个商品元素的显示状态</span><br>    <span class="hljs-title function_">updateGoodsItem</span>(<span class="hljs-params">index</span>) &#123;<br>        <span class="hljs-keyword">var</span> goodsDom = <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiGoods</span>.<span class="hljs-property">children</span>[index]<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">isChoose</span>(index)) &#123;<br>            goodsDom.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            goodsDom.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>        &#125;<br>        <span class="hljs-keyword">var</span> span = goodsDom.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.goods-btns span&#x27;</span>)<br>        span.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-property">uiGoods</span>[index].<span class="hljs-property">choose</span><br>    &#125;<br>    <span class="hljs-comment">// 更新页脚</span><br>    <span class="hljs-title function_">updateFooter</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 得到总价数据</span><br>        <span class="hljs-keyword">var</span> total = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">getTotalPrice</span>()<br>        <span class="hljs-comment">// 设置配送费</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">deliveryPrice</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">`配送费¥<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.uiData.deliveryPrice&#125;</span>`</span>;<br>        <span class="hljs-comment">// 设置起送费还差多少</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">isCrossDeliveryThreshold</span>()) &#123;<br>            <span class="hljs-comment">// 到达起送点</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">footerPay</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">footerPay</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>            <span class="hljs-comment">// 更新还差多少钱</span><br>            <span class="hljs-keyword">var</span> dis = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-property">deliveryThreshold</span> - toal<br>            dis = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(dis)<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">footerPayInnerSpan</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">`还差¥<span class="hljs-subst">$&#123;dis&#125;</span>元起送`</span><br>        &#125;<br>        <span class="hljs-comment">// 设置总价</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">totalPrice</span>.<span class="hljs-property">textContent</span> = total.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>)<br>        <span class="hljs-comment">// 设置购物车的状态</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">hasGoodsInCar</span>()) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">car</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">car</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;active&#x27;</span>)<br>        &#125;<br>        <span class="hljs-comment">// 设置购物车中的数量</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">badge</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiData</span>.<span class="hljs-title function_">getTotalChooseNumber</span>();<br>        <span class="hljs-comment">// 购物车动画</span><br>        <span class="hljs-title function_">carAnimate</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">car</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;animate&#x27;</span>)      <br>        &#125;<br><br>        <span class="hljs-comment">// 跳跃的抛物线,就是点击➕，加入购物车有一个滑向购物车的动作</span><br>        <span class="hljs-title function_">jump</span>(<span class="hljs-params">index</span>) &#123;<br>            <span class="hljs-comment">// 找到对应商品的加号</span><br>            <span class="hljs-keyword">var</span> btnAdd = <span class="hljs-variable language_">this</span>.<span class="hljs-property">doms</span>.<span class="hljs-property">goodsContainer</span>.<span class="hljs-property">children</span>[index].<span class="hljs-title function_">querSelector</span>(<span class="hljs-string">&#x27;.i-jiajianzujianjiahao&#x27;</span>);<br>            <span class="hljs-keyword">var</span> rect = btnAdd.<span class="hljs-title function_">getBoundingClientRect</span>();<br>            <span class="hljs-keyword">var</span> start = &#123;<br>                <span class="hljs-attr">x</span>: rect.<span class="hljs-property">left</span>,<br>                <span class="hljs-attr">y</span>: rect.<span class="hljs-property">top</span><br>            &#125;<br>            <span class="hljs-comment">// 开始跳</span><br>            <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>            div.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;add-to-car&#x27;</span><br>            <span class="hljs-keyword">var</span> i = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;i&#x27;</span>)<br>            i.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;iconfont i-jiajianzujianjiahao&#x27;</span><br>            <span class="hljs-comment">// 设置初始位置</span><br>            div.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">$&#123;start.x&#125;</span>px)`</span><br>            i.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateY(<span class="hljs-subst">$&#123;start.y&#125;</span>px)`</span><br>            div.<span class="hljs-title function_">appendChild</span>(i)<br>            <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br><br>            <span class="hljs-comment">// 在开始和结束中间要有一个强行渲染，不然就只会显示结束，开始到结束这个过程没有</span><br>            div.<span class="hljs-property">clientWidth</span>;<span class="hljs-comment">// 任何一个几何信息改动属性都会导致reflow</span><br>            <span class="hljs-comment">// 也可以用requestAnimationFrame() 告诉浏览器，你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画，该方法需要传入一个回调函数作为参数，该回调函数会在浏览器下一次重绘之前执行</span><br><br>            <span class="hljs-comment">// 设置结束位置</span><br>            div.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.jumpTarget.x&#125;</span>px,<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.jumpTarget.y&#125;</span>px)`</span><br>            i.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateY(<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.jumpTarget.y&#125;</span>px)`</span><br><br>            <span class="hljs-keyword">var</span> that = <span class="hljs-variable language_">this</span><br>            div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;transitioned&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                div.<span class="hljs-title function_">remove</span>()<br>                that.<span class="hljs-title function_">carAnimate</span>()<br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">once</span>:<span class="hljs-literal">true</span>, <span class="hljs-comment">// 事件仅触发一次</span><br>            &#125;)<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> ui = <span class="hljs-keyword">new</span> <span class="hljs-title function_">UI</span>()<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>css样式</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">    <span class="hljs-comment">/* 重力抛物线的时间函数 */</span></span><br><span class="language-css">    <span class="hljs-selector-class">.add-to-car</span> <span class="hljs-selector-class">.iconfont</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">transition</span>: <span class="hljs-number">0.6s</span> <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.5</span>,-<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)</span><br><span class="language-css">    &#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="5">
<li>事件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">ui.<span class="hljs-property">doms</span>.<span class="hljs-property">goodsContainer</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">if</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">&#x27;i-jiajianzujianjiahao&#x27;</span>)) &#123; <span class="hljs-comment">//contains 包含</span><br>        <span class="hljs-keyword">var</span> index = +e.<span class="hljs-property">target</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;index&#x27;</span>)<br>        ui.<span class="hljs-title function_">increase</span>(index)<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">&#x27;i-jianhao&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">var</span> index = +e.<span class="hljs-property">target</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;index&#x27;</span>)<br>        ui.<span class="hljs-title function_">decrease</span>(index)<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">John Doe</a></h1><div id="description"><p>支持大家讨论交流</p></div></div><div id="aside-block"><section id="total"><a id="total-archives" href="/archives"><span class="total-title">文章 总数:</span><span class="total-number">5</span></a><div id="total-tags"><span class="total-title">标签:</span><span class="total-number">1</span></div><div id="total-categories"><span class="total-title">分类:</span><span class="total-number">5</span></div></section></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>