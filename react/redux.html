<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>redux | ALin的个人博客</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="ALin的个人博客" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>redux</h1></div><hr><div id="post-content"><h2 id="redux"><a href="#redux" class="headerlink" title="redux"></a>redux</h2><p>是状态管理工具</p>
<h2 id="redux流程图"><a href="#redux流程图" class="headerlink" title="redux流程图"></a>redux流程图</h2><p class='item-img' data-src='/public/redux.png'><img src="/public/redux.png" alt="alt"></p>
<h3 id="action"><a href="#action" class="headerlink" title="action"></a>action</h3><p>动作的对象</p>
<ul>
<li>包含两个属性</li>
</ul>
<ol>
<li>type:’things type’</li>
<li>data:’things data’<br>例：</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<span class="hljs-attr">type</span>:<span class="hljs-string">&#x27;ADD_STUDENT&#x27;</span>,<span class="hljs-attr">data</span>:&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;tom&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>分为同步和异步<br>object一般对象action是同步</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-variable constant_">INCREMENT</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./constant&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createIncrementAction</span> = data =&gt; (&#123;<span class="hljs-attr">type</span>:<span class="hljs-variable constant_">INCREMENT</span>,data&#125;) <span class="hljs-comment">// 括号里包着返回一个对象，必须得括号包着不然认为你返回的是箭头函数结构</span><br></code></pre></td></tr></table></figure>

<p>函数类型的action是异步</p>
<ul>
<li>只有函数类型可以实现异步功能，其他类型做不到</li>
<li>异步action调用同步action，异步action不是必须要用的</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-variable constant_">INCREMENT</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./constant&#x27;</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createIncrementAsyncAction</span> = (<span class="hljs-params">data,time</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">createIncrementAction</span>(data))<br>        &#125;,time)<br>    &#125;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        这样写会报错：</span><br><span class="hljs-comment">        Error:Actions must be plain objects.Use custom middleware for async actions</span><br><span class="hljs-comment">    */</span><br><span class="hljs-comment">//    需要中间件 yarn add redux-thunk</span><br><span class="hljs-comment">// 在store.js中</span><br><span class="hljs-keyword">import</span> thunk <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-thunk&#x27;</span><br><span class="hljs-comment">// 暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">createStore</span>(countReducer,<span class="hljs-title function_">applyMiddleware</span>(thunk))<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>如果在组件内，连加几次都是+1，但采用异步action，是点几次就+几，区别还是很大的</li>
</ul>
<p>处理异步，传给mutation</p>
<h3 id="reducer"><a href="#reducer" class="headerlink" title="reducer"></a>reducer</h3><p>初始化状态，加工状态<br>加工时根据旧的state和action，返回一个新状态，产生新的state的纯函数</p>
<h3 id="store"><a href="#store" class="headerlink" title="store"></a>store</h3><p>将state、action、reducer联系在一起的对象</p>
<ul>
<li>如何得到此对象</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;createStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux&#x27;</span><br><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./reducers&#x27;</span><br><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer)<br></code></pre></td></tr></table></figure>

<ul>
<li>此对象的功能</li>
</ul>
<ol>
<li>getState() 得到state</li>
<li>dispatch(action):分发action，触发reducer调用，产生新的state</li>
<li>subscribe(listener):注册监听，当产生了新的state，自动调用</li>
</ol>
<h4 id="BTW—redux在vscode中使用"><a href="#BTW—redux在vscode中使用" class="headerlink" title="BTW—redux在vscode中使用"></a>BTW—redux在vscode中使用</h4><ul>
<li>yarn add redux</li>
<li>在src下专门建一个redux文件夹<br>redux中建立<ol>
<li>store.js 该文件专门用于暴露一个store对象，整个应用只有一个store对象</li>
</ol>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 引入createStore，专门用于创建redux中最为核心的store对象</span><br>store对象<span class="hljs-keyword">import</span> &#123;createstore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span><br><span class="hljs-comment">//引入为Count件服务的reducer</span><br><span class="hljs-keyword">import</span> countReducer <span class="hljs-keyword">from</span>.<span class="hljs-string">&quot;./count reducer&quot;</span> <br><span class="hljs-comment">//暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">createStore</span>(countReducer)<br><br></code></pre></td></tr></table></figure>

<pre><code>2. xxx_reducer.js 
    该文件是用于创建一个为Count组件服务的reducer
    reducer的本质就是一个函数
    reducer函数会接收到两个参数，分别为：之前的状态（preState,动作对象(action)）
    reducer被第一次调用的时候，是store自动触发的
        传递的preState是undefined
        传递的action是&#123;type:&#39;&#39;&#125;
3. index.js
    监测store中状态改变，一旦发生改变重新渲染&lt;App/&gt;

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 监测redux中状态的改变，若redux的状态发生了改变，重新渲染App组件</span><br>    store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>))<br>    &#125;)<br><span class="hljs-comment">// 这个在下面优化例子中不需要写了，因为connect方法解决了</span><br></code></pre></td></tr></table></figure>

4. 去除Count组件自身的状态
5. count_action.js 专门用于创建action对象
        import INCREMENT from &#39;./constant&#39;
        export const createIncrementAction = data =&gt; (&#123;type:INCREMENT,data&#125;)
   constant.js放置容易编码疏忽写错action中的type
        export const INCREMENT = &#39;increment&#39;
</code></pre>
<p>this.setState()方法</p>
<ol>
<li>重新渲染，帮你调用render方法</li>
<li>帮你改状态</li>
</ol>
<h2 id="容器组件与UI组件连接"><a href="#容器组件与UI组件连接" class="headerlink" title="容器组件与UI组件连接"></a>容器组件与UI组件连接</h2><p>UI组件放在components中<br>容器组件新建一个文件夹container与components同级<br class='item-img' data-src='/public/redux_container.png'><img src="/public/redux_container.png" alt="alt"></p>
<ul>
<li>容器组件不可以用rcc直接生成，要自己写</li>
</ul>
<p>例子：container文件夹中有Count文件夹下的index.jsx</p>
<ol>
<li>yarn add react-redux</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//2. 引入Count的UI组件</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">CountUI</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../componnets/Count&#x27;</span><br><span class="hljs-comment">// 3. 引入redux，其实就是引入redux文件夹中的store</span><br>    <span class="hljs-comment">// import store from &#x27;../../redux/store&#x27;</span><br><span class="hljs-comment">// 4. 引入connect用于连接UI组件与redux</span><br><span class="hljs-keyword">import</span> &#123;connect&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-redux&#x27;</span><br><span class="hljs-comment">/* connect()() 首先可以看出connect是一个函数 其次connect函数调用的返回值依然是一个函数 */</span><br><br><span class="hljs-comment">// 使用connect()()创建并暴露一个Count的容器组件</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">CountContainer</span> = <span class="hljs-title function_">connect</span>()(<span class="hljs-title class_">CountUI</span>)<br><br><span class="hljs-comment">/*报错因为store不应该在这引入 */</span><br><span class="hljs-comment">// App.jsx</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./redux/store&#x27;</span><br><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            &#123;/* 给容器组件传递store */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">Count</span> <span class="hljs-attr">store</span>=<span class="hljs-string">&#123;store&#125;/</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    )<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>UI组件</li>
</ul>
<ol>
<li>展示redux状态</li>
<li>根据用户行为操作redux状态</li>
</ol>
<ul>
<li>容器组件<br>与redux连接，给UI传递redux中的状态<br>容器组件会传递给UI组件：<br>a. redux中保存的状态<br>b. 用于操作状态的方法</li>
</ul>
<ol>
<li>所有与redux打交道的东西全部交给容器组件，容器组件接过来通过props传给UI组件展示</li>
<li>容器组件传递一个操作状态方法，在UI组件调用父亲（容器组件）给你的这个函数，东西给父亲（容器组件）</li>
<li>父亲（容器组件）再去操作redux</li>
</ol>
<p>容器组件从redux文件夹中读东西？store.getState()<br>容器组件影响redux中的状态 store.dispatch(action)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 继续上面container中的代码，看起来像是无法给子组件传递任何东西 </span><br><br><span class="hljs-comment">// a函数的返回的对象中的key就作为传递给UI组件props的key,value就作为传递给UI组件props的value ———— 状态</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params">state</span>) &#123;<br>    <span class="hljs-comment">// return 1 不可以这么写，因为要通过props传递，需要是一个key,value对象，this.props.key或者其他，若只是数字如何接收</span><br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">count</span>:state&#125; <span class="hljs-comment">// redux中的状态 </span><br>&#125;<br><span class="hljs-comment">// b函数的返回的对象中的key就作为传递给UI组件props的key,value就作为传递给UI组件props的value ———— 操作状态的方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">dispatch</span>) &#123;<br>    <span class="hljs-comment">//  return &#123;jia:() =&gt; &#123;console.log(2)&#125;&#125;</span><br>    <br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-title function_">jia</span>(number) =&gt; &#123;<br>        <span class="hljs-comment">// 通知redux执行加法</span><br>        <span class="hljs-comment">// StorageEvent.dispatch(&#123;type:&#x27;increment&#x27;,data:number&#125;)</span><br>        <span class="hljs-comment">// store.dispatch(&#123;type:&#x27;increment&#x27;,data:number&#125;)  把它放到action中一起封装，然后引入</span><br>        <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">createIncrementAction</span>(number))<br>    &#125;&#125;<br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">CountContainer</span> = <span class="hljs-title function_">connect</span>(a,b)(<span class="hljs-title class_">CountUI</span>) <br><br><span class="hljs-comment">// 第一个括号的参数里面要写函数不可以是其他形式</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure>

<h3 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h3><p>connect负责连接React和Redux<br>connect作用是让你把组件和store连接起来，产生一个新的组件（connect 是高阶组件）</p>
<ul>
<li><p>获取state<br>connect 通过 context获取 Provider 中的 store，通过 store.getState() 获取整个store tree 上所有state</p>
</li>
<li><p>包装原组件<br>将state和action通过props的方式传入到原组件内部 wrapWithConnect 返回—个 ReactComponent 对象 Connect，Connect重新 render 外部传入的原组件 WrappedComponent ，并把 connect 中传入的 mapStateToProps（也就是上面的a函数），mapDispatchToProps（上面的b函数）与组件上原有的 props 合并后，通过属性的方式传给 WrappedComponent</p>
</li>
<li><p>监听store tree变化<br>connect缓存了store tree中state的状态，通过当前state状态 和变更前 state 状态进行比较，从而确定是否调用 this.setState()方法触发 Connect 及其子组件的重新渲染</p>
</li>
<li><p>redux的connect( )参数<br>connect接受四个参数<br>mapStateToProps?: Function<br>mapDispatchToProps?: Function | Object<br>mergeProps?: Function （不常用）<br>options?: Object (不常用)</p>
</li>
<li><p>mapStateToProps 和 mapDispatchToProps 分别处理 Redux store 的 state 和 dispatch。state 和 dispatch 将作为第一个参数提供给 mapStateToProps 或 mapDispatchToProps 函数</p>
</li>
<li><p>connect工作流程<br>Provider组件，在原应用组件上包裹一层，使原来整个应用成为Provider的子组件<br>接收Redux的store作为props，通过context对象传递给子孙组件上的connect</p>
</li>
</ul>
<p>它真正连接 Redux 和 React，它包在我们的容器组件的外一层，它接收上面 Provider 提供的 store 里面的 state 和 dispatch，传给一个构造函数，返回一个对象，以属性形式传给我们的容器组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><span class="hljs-comment">// 在这里面需要传递store给容器组件，但若有很多个容器则需要传递很多次，例如</span><br>&lt;<span class="hljs-title class_">Count</span> store=&#123;store&#125;&gt;&lt;/<span class="hljs-title class_">Count</span>&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Demo</span> <span class="hljs-attr">store</span>=<span class="hljs-string">&#123;store&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Demo</span>&gt;</span></span><br><span class="hljs-comment">/* 这样非常麻烦，所以用Provider组件 */</span><br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">&#123;store&#125;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>)<br>)<br></code></pre></td></tr></table></figure>

<h4 id="优化上述代码总结"><a href="#优化上述代码总结" class="headerlink" title="优化上述代码总结"></a>优化上述代码总结</h4><ol>
<li>容器组件和UI组件整合成一个组件</li>
<li>无需自己给容器组件传递store，给<App/>包裹一个<Provider store={store}/>即可</li>
<li>使用react-redux后也不用再自己检测redux中状态的改变了，容器组件可以自动完成这个工作，不需要</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>           <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>))<br>&#125;)<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>mapDispatchToProps也可以简单写成一个对象</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// mapDispatchToProps的一般写法</span><br>dispatch =&gt; (&#123;<br>    <span class="hljs-attr">jia</span>:<span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">createIncrementAction</span>(number))<br>    <span class="hljs-attr">jian</span>:<span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">createDecrementAction</span>(number))<br>    <span class="hljs-attr">jiaAsync</span>:<span class="hljs-function">(<span class="hljs-params">number,time</span>) =&gt;</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-title function_">createIncrementAsyncAction</span>(number,time))<br>&#125;)<br><span class="hljs-comment">// 简写</span><br><span class="hljs-attr">jia</span>:createIncrementAction,<br><span class="hljs-attr">jian</span>:createDecrementAction,<br><span class="hljs-attr">jiaAsync</span>:createIncrementAsyncAction<br><br></code></pre></td></tr></table></figure>

<ol start="5">
<li>一个组件和redux打交道要经过哪几步</li>
</ol>
<ul>
<li>定义好一个UI组件————不暴露</li>
<li>引入connect生成一个容器组件，并暴露<br>  connect(<pre><code>  state =&gt; (&#123;key:value&#125;), // 映射状态
  &#123;key:xxxAction&#125; //映射操作状态方法
</code></pre>
  )(UI组件)</li>
<li>在UI组件中通过this.props.xxxx读取和操作状态</li>
</ul>
<h2 id="合并reducer"><a href="#合并reducer" class="headerlink" title="合并reducer"></a>合并reducer</h2><p>store.js</p>
<ul>
<li>combineReducers</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;createStore,applyMiddleware,combineReducers&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span><br><span class="hljs-comment">// 汇总所有的reducer变成一个总的reducer</span><br><span class="hljs-keyword">const</span> allReducer = <span class="hljs-title function_">combineReducers</span>(&#123; <span class="hljs-comment">// 就是redux帮忙保存的&#123;key,value&#125;</span><br>    <span class="hljs-attr">sum</span>:countReducer,<br>    <span class="hljs-attr">person</span>:personReducer<br>&#125;)<br><span class="hljs-comment">// 因为放到一起，所以count，和person组件中state后面要加后缀名</span><br><span class="hljs-comment">// count/index.jsx</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">connect</span>(<br>    <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> (&#123;<span class="hljs-attr">count</span>:state.<span class="hljs-property">sum</span>&#125;)<br>) (<span class="hljs-title class_">CountUI</span>)<br></code></pre></td></tr></table></figure>

<p>redux帮我们保存的总状态是一个对象，combineReducer调用传入的对象就是redux帮我们保存的那个对象</p>
<h3 id="person与count组件进行数据共享"><a href="#person与count组件进行数据共享" class="headerlink" title="person与count组件进行数据共享"></a>person与count组件进行数据共享</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// count/index.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">connect</span>(<br>    <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> (&#123;<span class="hljs-attr">count</span>:state.<span class="hljs-property">sum</span>,<span class="hljs-attr">renshu</span>:state.<span class="hljs-property">person</span>.<span class="hljs-property">length</span>&#125;)<br>) (<span class="hljs-title class_">CountUI</span>)<br></code></pre></td></tr></table></figure>

<p>[AIA]:求和案例 react redux数据共享版<br>(1).定义一个Person组件，和Count组件通过redux共享数据。<br>(2).为Person组件编写: reducer、action，配置constant常量。<br>(3).重点:Person的reducer和Count的Reducer要使用combineReducers进行合并合并后的总状态是一个对象!! !<br>(4).交给store的是总reducer，最后注意在组件中取出状态的时候，记得“取到位”</p>
<h2 id="纯函数"><a href="#纯函数" class="headerlink" title="纯函数"></a>纯函数</h2><p>一类特别的函数：只要是同样的输入（实参），必定得到同样的输出（返回）<br>必定遵守以下约束：</p>
<ol>
<li>不得改写参数数据</li>
<li>不会产生副作用，例如网络请求，输入和输出设备</li>
<li>不能调用Date.now()或者Math.random()等不纯的方法<br>redux中的reducer函数必须是一个纯函数</li>
</ol>
<h4 id="BTW–开发者工具"><a href="#BTW–开发者工具" class="headerlink" title="BTW–开发者工具"></a>BTW–开发者工具</h4><p>yarn add redux-devtools-extension</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//store.js</span><br><span class="hljs-comment">// 引入redux-devtools-extension</span><br><span class="hljs-keyword">import</span> &#123;composeWithDevTools&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux-devtools-extension&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">createStore</span>(allReducer,<span class="hljs-title function_">composeWithDevTools</span>(<span class="hljs-title function_">applyMiddleware</span>(thunk)))<br></code></pre></td></tr></table></figure>


<h2 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h2><p>两种写法</p>
<ol>
<li>对象式的写法<br>setState(stateChange,[callback])</li>
</ol>
<ul>
<li>stateChange为状态改变对象（该对象可以体现出状态的更改）</li>
<li>callback是可选的回调函数，它在状态更新完毕，界面也更新后（render调用后）才被调用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">state = &#123;<span class="hljs-attr">count</span>:<span class="hljs-number">0</span>&#125;<br><span class="hljs-comment">// 1.获取原来的count值</span><br><span class="hljs-keyword">const</span> &#123;count&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">setState</span> = (&#123;<span class="hljs-attr">count</span>:count+<span class="hljs-number">1</span>&#125;,<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// callback回调</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">count</span>)<br>    <span class="hljs-comment">// 比如改完了想看一看，在这个回调中可以看到最准确的</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>函数式的setState<br>setState(updater,[callback])</li>
</ol>
<ul>
<li>updater为返回stateChange对象的函数</li>
<li>updater可以接收到state和props</li>
<li>callback是可选的回调函数，它在状态更新完毕，界面也更新后（render调用后）才被调用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">state = &#123;<span class="hljs-attr">count</span>:<span class="hljs-number">0</span>&#125;<br><span class="hljs-comment">// 无需先获取原来的状态值，函数式可以接收到state和props</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(<span class="hljs-function">(<span class="hljs-params">state,props</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">count</span>:state.<span class="hljs-property">count</span>+<span class="hljs-number">1</span>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>[AIA]: </p>
<ol>
<li>对象式的setState是函数式的etState简写方式(语法糖)</li>
<li>使用原则<br>如果新状态不依赖于原状态 ===&gt; 使用对象方式<br>如果新状态依赖于原状态 ===&gt; 使用函数方式</li>
</ol>
<h2 id="lazyload"><a href="#lazyload" class="headerlink" title="lazyload"></a>lazyload</h2><p>定义变量+箭头函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>,&#123;<span class="hljs-title class_">Component</span>,lazy,<span class="hljs-title class_">Suspense</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-comment">// import Home from &#x27;./Home&#x27;</span><br><span class="hljs-comment">// 不这样写，用下述方式</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Home</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./Home&#x27;</span>)&#125;)<br><span class="hljs-comment">// Suspense用在下方注册路由的地方</span><br>&lt;div className=<span class="hljs-string">&quot;list-group&quot;</span>&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">NavLink</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;list-group-item&quot;</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">NavLink</span>&gt;</span></span><br>&lt;/div&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pannel_body&quot;</span>&gt;</span></span><br><span class="language-xml">     <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">&#123;</span>&lt;<span class="hljs-attr">h1</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>&#125;&gt;</span><br><span class="language-xml">        &#123;/* 这个h1可以换成<span class="hljs-tag">&lt;<span class="hljs-name">Loading</span>/&gt;</span>建一个loading组件，配置加载时候的样子 */&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/home&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&#123;Home&#125;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  <br></code></pre></td></tr></table></figure>

<h2 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h2><p>stateHooks<br>函数式组件没有自己的this，但也可以用state，props，ref</p>
<ol>
<li>state Hook:React.useState()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Demo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// const [a,b] = React.useState(0)</span><br>    <span class="hljs-comment">// a是0，b第二个参数是函数，可以更新这个0</span><br>    <span class="hljs-comment">// 为了语义化，规范一些</span><br>    <span class="hljs-keyword">const</span> [count,setCount] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-comment">// 加的回调</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// setCount(count+1)</span><br>        <span class="hljs-comment">// 第二种书写方式</span><br>        <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">count</span> =&gt;</span> count+<span class="hljs-number">1</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>当前求和为:&#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;add&#125;</span>&gt;</span>点我加1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    )<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>effect Hooks:React.useEffect()<br>不可以在这里面开定时器，否则相当于在render中开定时器</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;@&#x27;</span>)<br>&#125;) <br><span class="hljs-comment">// @一直在输出，在组件挂载和更新的时候执行，相当于componentDidMount和componentDidUpdate</span><br><span class="hljs-comment">/* 但若是 */</span><br><span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;@&#x27;</span>)<br>&#125;,[]) <br><span class="hljs-comment">// @只输出一次，相当于componentDidMount</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    [] 有监测的意思，若没写第二个参数相当于监测所有人，若写了表示 谁也不检测</span><br><span class="hljs-comment">    [count]括号里面写什么就监测什么</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">count</span> =&gt;</span> count+<span class="hljs-number">1</span>)<br>        <span class="hljs-comment">// setCount(count+1)</span><br>        <span class="hljs-comment">/*这回这两个不一样 */</span><br>    &#125;,<span class="hljs-number">1000</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-built_in">clearInterval</span>(timer)<br>    &#125;<br>&#125;,[]) <br><span class="hljs-comment">// 卸载组件的回调</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">unmount</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">unmountComponentAtNode</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>))<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>react中副作用操作：<br>发送ajax请求数据获取<br>设置订阅/启动定时器<br>手动更改真实DOM</li>
<li>语法和说明<br>useEffect(() =&gt; {<br>  // 在此可以执行任何副作用操作<br>  return () =&gt; {//在组件卸载前执行<pre><code>  // 在此做一些收尾工作，比如清楚定时器/取消订阅等
</code></pre>
  }<br>}[stateValue]) // 如果指定的[]，回调函数只会在第一次render()后执行</li>
<li>可以把useEffect Hook 看做如下三个函数的组合<br>componentDidMount()<br>componentDidUpdate()<br>componentWillMount()</li>
</ul>
<ol start="3">
<li>ref Hook:React.useRef()</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> myRef = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useRef</span>()<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">alert</span>(myRef.<span class="hljs-property">current</span>.<span class="hljs-property">value</span>)<br>&#125;<br><span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;myRef&#125;/</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;show&#125;</span>&gt;</span>点我提示数据<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>)<br></code></pre></td></tr></table></figure>
<ul>
<li>ref返回一个dom元素，可以操作原生</li>
</ul>
<h2 id="fragment"><a href="#fragment" class="headerlink" title="fragment"></a>fragment</h2><p>当不得不包一个标签的时候，可以不包div，用<Fragment></Fragment>标签来代替<br>因为fragment会被react解析，丢掉<br>只接受一个标签属性key，接收别的比如name=”tom”,React.Fragment can only have <code>key</code> and <code>children</code> props</p>
<h2 id="context"><a href="#context" class="headerlink" title="context"></a>context</h2><p>组件间通信方式，常用于【祖组件】与【后代组件】间通信</p>
<ul>
<li>类式组件</li>
</ul>
<ol>
<li>创建Context对象<br>const MyContext = React.createContext()</li>
<li>const {Provider} = MyContext</li>
<li>祖组件中Provider包裹着父组件；在下方父组件包裹着子组件</li>
<li>后代读取数据：static contextType = MyContext</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 创建Context对象</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>()<br><span class="hljs-keyword">const</span> &#123;<span class="hljs-title class_">Provider</span>&#125; = <span class="hljs-title class_">MyContext</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    state = &#123;<span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;tom&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123;username,age&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span><br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是A组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>我的用户名:&#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span></span><br><span class="language-xml">                &#123;/* <span class="hljs-tag">&lt;<span class="hljs-name">MyContext.Provider</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">MyContext.Provider</span>&gt;</span>上面const &#123;Provider&#125; = MyContext就不需要这么写了 */&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;username,age&#125;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">B</span>/&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    state = &#123;<span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;tome&#x27;</span>&#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是B组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>我的用户名:&#123;this.state.username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">C</span>/&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    <span class="hljs-comment">// 后代读取数据，适用于类组件</span><br>    <span class="hljs-keyword">static</span> contextType = <span class="hljs-title class_">MyContext</span><br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123;username,age&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> <span class="hljs-comment">// 写这个是为了下面h4中,可以直接使用，无需➕前缀this.context</span><br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是B组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>我的用户名:&#123;username&#125;,年龄时:&#123;age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">C</span>/&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>函数组件（类组件也可以用这种方式）</li>
</ul>
<ol>
<li>引入Consumer<br>&lt;xxxContext.Consumer&gt;<br> {<pre><code> value =&gt; &#123; value 就是context中的value数据
     return 
 &#125;
</code></pre>
 }<br>&lt;/xxxContext.Consumer&gt;</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 其他代码同上，只有C组件变为函数组件</span><br>    <span class="hljs-keyword">const</span> &#123;<span class="hljs-title class_">Provider</span>,<span class="hljs-title class_">Consumer</span>&#125; = <span class="hljs-title class_">MyContext</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">C</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;grand&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是C组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>从A组件接收到的用户名:</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">Consumer</span>&gt;</span></span><br><span class="language-xml">                        &#123;</span><br><span class="language-xml">                            value =&gt; &#123;</span><br><span class="language-xml">                                return `$&#123;value.username&#125;,年龄时$&#123;value.age&#125;`</span><br><span class="language-xml">                            &#125;          </span><br><span class="language-xml">                        &#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Consumer</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="优化optimize————PureComponent"><a href="#优化optimize————PureComponent" class="headerlink" title="优化optimize————PureComponent"></a>优化optimize————PureComponent</h2><p>不需要render的时候，让它不渲染<br>可以使用shouldComponentUpdate来进行判断<br>比如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">shouldComponentUpdate</span>(<span class="hljs-params">nextProps,nextState</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>) <span class="hljs-comment">// 目前的props和state</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nextProps,nextState) <span class="hljs-comment">// 接下来要变化的目标props，目标state</span><br>    <span class="hljs-keyword">return</span> !<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">carName</span> === nextState.<span class="hljs-property">carName</span><br>&#125;<br><span class="hljs-comment">// 现实生活中不需要这么麻烦，可以用PureComponent</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>,&#123;<span class="hljs-title class_">PureComponent</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PureComponent</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>PureComponent只有state和props发生改变的才返回true<br>【注意】：</li>
</ul>
<ol>
<li>只是进行state和props浅比较，如果只是数据对象内部数据变了，返回false</li>
<li>不要直接修改state数据，而是要产生新数据</li>
</ol>
<h3 id="BTW————改变状态"><a href="#BTW————改变状态" class="headerlink" title="BTW————改变状态"></a>BTW————改变状态</h3><p class='item-img' data-src='/public/wrongshow.png'><img src="/public/wrongshow.png" alt="alt"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 上述方法错误</span><br><span class="hljs-comment">// 用字面量形式构建新数组</span><br>addStu = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> &#123;stus&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">stus</span>:[<span class="hljs-string">&#x27;小刘&#x27;</span>,...stus]&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="renderProps"><a href="#renderProps" class="headerlink" title="renderProps"></a>renderProps</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;parent&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是parent组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                &#123;/* hello!无法展现出来，但是它藏在children中，标签体内容在children中 */&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">A</span>&gt;</span></span><br><span class="language-xml">                    &#123;/* B组件如何展示在页面上,不写在A组件中，也是A的子组件 */&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">B</span>/&gt;</span> </span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">A</span>&gt;</span> </span><br><span class="language-xml">                &#123;/* 用下面这种方式 */&#125;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">render</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">B</span>/&gt;</span>&#125;/&gt;</span><br><span class="language-xml">                 &#123;/* 给A传递了一个标签属性，名为render，值为一个函数，该函数调用的返回值是B组件 */&#125;</span><br><span class="language-xml">                 &#123;/* 接收到A组件传递给B组件参数 */&#125;</span><br><span class="language-xml">                  <span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">render</span>=<span class="hljs-string">&#123;(name)</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">B</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#123;name&#125;/</span>&gt;</span>&#125;/&gt;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    state = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;tom&#x27;</span>&#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123;name&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span><br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;a&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是A组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                &#123;/* 这样 hello!就出来了*/&#125;</span><br><span class="language-xml">                    &#123;this.props.children&#125; </span><br><span class="language-xml">                &#123;/* 展示B组件 */&#125;</span><br><span class="language-xml">                    &#123;this.props.render(name)&#125; // 接收到A组件传递给B组件参数</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;    <br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;           <br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;b&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>我是B组件<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                t</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="错误辩解ErrorBoundary"><a href="#错误辩解ErrorBoundary" class="headerlink" title="错误辩解ErrorBoundary"></a>错误辩解ErrorBoundary</h2><p>把错误控制在范围里，在容易发生错误的那个组件的父组件里去操作<br>用到与新提出的生命周期getDeriveStateFromProps类似的东西,若state的值任何时候都取决于props，可以使用<br>getDerivedStateFromError</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>    state = &#123;<br>        <span class="hljs-attr">hasError</span>:<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">// 用于标识子组件是否产生错误</span><br>    &#125;<br>    <span class="hljs-comment">// 当parent的子组件出现报错时，会触发getDerivedStateFromError调用，并携带错误信息</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDerivedStateFromError</span>(<span class="hljs-params">error</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">hasError</span>:error&#125;<br>    &#125;<br>    <span class="hljs-title function_">componentDidCatch</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;此处统计错误，发送给后台，反馈给服务器，用于通知编码人员进行bug的解决&#x27;</span>)<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> (<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>我是Parent组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">                &#123;/* 下面这个应该是解开的，但在这里解开容易报错 */&#125;</span><br><span class="language-xml">                    &#123;/* &#123;this.state.hasError ? <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>当前网络不稳定稍后再试<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">Child</span>/&gt;</span>&#125; */&#125;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>注意：这个错误边界只能用在生产环境中，开发环境中不好使<br>  只能捕获后代生命周期产生的错误，不能捕获自己组件产生的错误和其他组件在合成事件、定时器中产生的错误 </li>
</ul>
<div id="paginator"></div></div><div id="post-footer"></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">John Doe</a></h1><div id="description"><p>支持大家讨论交流</p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#redux"><span class="toc-number">1.</span> <span class="toc-text">redux</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redux%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">2.</span> <span class="toc-text">redux流程图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#action"><span class="toc-number">2.1.</span> <span class="toc-text">action</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reducer"><span class="toc-number">2.2.</span> <span class="toc-text">reducer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#store"><span class="toc-number">2.3.</span> <span class="toc-text">store</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BTW%E2%80%94redux%E5%9C%A8vscode%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">BTW—redux在vscode中使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E7%BB%84%E4%BB%B6%E4%B8%8EUI%E7%BB%84%E4%BB%B6%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.</span> <span class="toc-text">容器组件与UI组件连接</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#connect"><span class="toc-number">3.1.</span> <span class="toc-text">connect</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E4%B8%8A%E8%BF%B0%E4%BB%A3%E7%A0%81%E6%80%BB%E7%BB%93"><span class="toc-number">3.1.1.</span> <span class="toc-text">优化上述代码总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E5%B9%B6reducer"><span class="toc-number">4.</span> <span class="toc-text">合并reducer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#person%E4%B8%8Ecount%E7%BB%84%E4%BB%B6%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB"><span class="toc-number">4.1.</span> <span class="toc-text">person与count组件进行数据共享</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%AF%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">纯函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BTW%E2%80%93%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7"><span class="toc-number">5.0.1.</span> <span class="toc-text">BTW–开发者工具</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setState"><span class="toc-number">6.</span> <span class="toc-text">setState</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lazyload"><span class="toc-number">7.</span> <span class="toc-text">lazyload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hooks"><span class="toc-number">8.</span> <span class="toc-text">Hooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fragment"><span class="toc-number">9.</span> <span class="toc-text">fragment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#context"><span class="toc-number">10.</span> <span class="toc-text">context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96optimize%E2%80%94%E2%80%94%E2%80%94%E2%80%94PureComponent"><span class="toc-number">11.</span> <span class="toc-text">优化optimize————PureComponent</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BTW%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E6%94%B9%E5%8F%98%E7%8A%B6%E6%80%81"><span class="toc-number">11.1.</span> <span class="toc-text">BTW————改变状态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#renderProps"><span class="toc-number">12.</span> <span class="toc-text">renderProps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E8%BE%A9%E8%A7%A3ErrorBoundary"><span class="toc-number">13.</span> <span class="toc-text">错误辩解ErrorBoundary</span></a></li></ol></div><section id="total"><a id="total-archives" href="/archives"><span class="total-title">文章 总数:</span><span class="total-number">5</span></a><div id="total-tags"><span class="total-title">标签:</span><span class="total-number">1</span></div><div id="total-categories"><span class="total-title">分类:</span><span class="total-number">5</span></div></section></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>